@model BusinessLogicLayer.Dtos.ContactDtos.ContactMessageCreateDto

<body class="template-color-1">
    <div class="main-wrapper">
        <!-- Begin Hiraola's Breadcrumb Area -->
        <div class="breadcrumb-area">
            <div class="container">
                <div class="breadcrumb-content">
                    <h2>Liên Hệ</h2>
                    <ul>
                        <li><a href="/">Trang Chủ</a></li>
                        <li class="active">Liên Hệ</li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- Hiraola's Breadcrumb Area End Here -->
        <!-- Begin Contact Main Page Area -->
        <div class="contact-main-page">
            <div class="container">
                <div class="row">
                    <div class="col-lg-5 offset-lg-1 col-md-12 order-1 order-lg-2">
                        <div class="contact-page-side-content">
                            <h3 class="contact-page-title">Liên Hệ Với Chúng Tôi</h3>
                            <p class="contact-page-message">
                                Chúng tôi luôn sẵn sàng lắng nghe ý kiến của bạn. Vui lòng liên hệ để được hỗ trợ hoặc gửi phản hồi về sản phẩm và dịch vụ của chúng tôi.
                            </p>
                            <div class="single-contact-block">
                                <h4><i class="fa fa-fax"></i> Địa Chỉ</h4>
                                <p>123 Đường Lê Lợi, Quận 1, TP. Hồ Chí Minh, Việt Nam</p>
                            </div>
                            <div class="single-contact-block">
                                <h4><i class="fa fa-phone"></i> Số Điện Thoại</h4>
                                <p>Di động: (028) 1234 5678</p>
                                <p>Hotline: 1800 6789</p>
                            </div>
                            <div class="single-contact-block last-child">
                                <h4><i class="fa fa-envelope-o"></i> Email</h4>
                                <p>hotro@ourobos.vn</p>
                                <p>kinhdoanh@ourobos.vn</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-12 order-2 order-lg-1">
                        <div class="contact-form-content">
                            <h3 class="contact-page-title">Gửi Tin Nhắn Của Bạn</h3>
                            <div class="contact-form">
                                <form id="contact-form" asp-action="SendMessage" asp-controller="Contact" method="post">
                                    <div class="form-group">
                                        <label>Tên của bạn <span class="required">*</span></label>
                                        <input type="text" asp-for="Name" required>
                                        <span asp-validation-for="Name" class="text-danger"></span>
                                    </div>
                                    <div class="form-group">
                                        <label>Email của bạn <span class="required">*</span></label>
                                        <input type="email" asp-for="Email" required>
                                        <span asp-validation-for="Email" class="text-danger"></span>
                                    </div>
                                    <div class="form-group">
                                        <label>Chủ đề</label>
                                        <input type="text" asp-for="Subject">
                                        <span asp-validation-for="Subject" class="text-danger"></span>
                                    </div>
                                    <div class="form-group form-group-2">
                                        <label>Nội dung tin nhắn <span class="required">*</span></label>
                                        <textarea asp-for="Message" required></textarea>
                                        <span asp-validation-for="Message" class="text-danger"></span>
                                    </div>
                                    <div class="form-group">
                                        <button type="submit" class="hiraola-contact-form_btn" id="submit-btn">Gửi</button>
                                    </div>
                                </form>
                                <p class="form-message mt-3 mb-0" id="form-message"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Contact Main Page Area End Here -->
    </div>
    <!-- Thêm jQuery và jQuery Validation -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script>
        $(document).ready(function () {
            // Kiểm tra xem jQuery Validation đã tải chưa
            if (!$.fn.validate) {
                console.error("jQuery Validation plugin không được tải.");
                $("#form-message").addClass("text-danger").text("Lỗi: Không thể tải plugin xác thực. Vui lòng thử lại sau.");
                return;
            }

            // Cấu hình jQuery Validation
            $("#contact-form").validate({
                rules: {
                    Name: {
                        required: true,
                        maxlength: 100
                    },
                    Email: {
                        required: true,
                        email: true,
                        maxlength: 100
                    },
                    Subject: {
                        maxlength: 200
                    },
                    Message: {
                        required: true,
                        maxlength: 2000
                    }
                },
                messages: {
                    Name: {
                        required: "Vui lòng nhập tên của bạn.",
                        maxlength: "Tên không được vượt quá 100 ký tự."
                    },
                    Email: {
                        required: "Vui lòng nhập email của bạn.",
                        email: "Email không hợp lệ.",
                        maxlength: "Email không được vượt quá 100 ký tự."
                    },
                    Subject: {
                        maxlength: "Chủ đề không được vượt quá 200 ký tự."
                    },
                    Message: {
                        required: "Vui lòng nhập nội dung tin nhắn.",
                        maxlength: "Nội dung không được vượt quá 2000 ký tự."
                    }
                },
                // Xử lý gửi biểu mẫu
                submitHandler: async function (form, event) {
                    event.preventDefault(); // Ngăn hành vi gửi mặc định

                    const $submitBtn = $("#submit-btn");
                    const $formMessage = $("#form-message");

                    // Vô hiệu hóa nút gửi và hiển thị trạng thái đang xử lý
                    $submitBtn
                        .prop("disabled", true)
                        .text("Đang gửi...")
                        .addClass("disabled");

                    // Xóa thông báo trước đó
                    $formMessage.removeClass("text-success text-danger").text("");

                    try {
                        // Gửi yêu cầu POST bất đồng bộ
                        const response = await $.ajax({
                            url: form.action,
                            type: form.method,
                            data: $(form).serialize(),
                            dataType: "json", // Giả sử server trả về JSON
                            headers: {
                                "RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val()
                            }
                        });

                        // Xử lý phản hồi thành công
                        $formMessage
                            .addClass("text-success")
                            .text("Tin nhắn của bạn đã được gửi thành công!");
                        form.reset(); // Xóa biểu mẫu
                        $("#contact-form").validate().resetForm(); // Xóa trạng thái xác thực
                    } catch (error) {
                        // Xử lý lỗi
                        let errorMessage = "Có lỗi xảy ra khi gửi tin nhắn. Vui lòng thử lại.";
                        if (error.responseJSON && error.responseJSON.message) {
                            errorMessage = error.responseJSON.message;
                        }
                        $formMessage.addClass("text-danger").text(errorMessage);
                    } finally {
                        // Kích hoạt lại nút gửi
                        $submitBtn
                            .prop("disabled", false)
                            .text("Gửi")
                            .removeClass("disabled");
                    }
                }
            });
        });
    </script>
</body>